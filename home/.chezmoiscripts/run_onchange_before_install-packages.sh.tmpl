#!/bin/bash

set -eufo pipefail

{{ $brews := list
    "cargo-binstall"
    "chezmoi"
    "gromgit/brewtils/taproom"
    "mise"
-}}

{{ $casks := (list
    "font-iosevka"
    "font-iosevka-nerd-font"
    "font-commit-mono"
    "ghostty@tip"
) -}}

{{ if .work -}}
{{ $brews = concat $brews (list
    "colima"
    "crossplane"
    "devtui"
    "docker"
    "docker-buildx"
    "docker-completion"
    "docker-compose"
    "docker-credential-helper"
    "gnu-sed"
    "helm-ls"
    "joemiller/taps/vault-token-helper"
    "kubecolor"
    "starship"
) -}}

{{ $casks = concat $casks (list) -}}
{{ end -}}

brew bundle --file=/dev/stdin <<EOF
{{ range ($brews | sortAlpha | uniq) -}}
brew "{{ . }}"
{{ end -}}

{{ range ($casks | sortAlpha | uniq) -}}
cask "{{ . }}"
{{ end -}}
EOF
